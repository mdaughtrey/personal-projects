---
id: 963
title: 'A Mask For Every Occasion'
date: '2020-10-20T23:06:06-04:00'
author: mdaughtrey
layout: post
guid: 'http://daughtrey.com/?p=963'
permalink: '/?p=963'
categories:
    - BlueMouth
---

<div class="aligncenter wp-block-ugb-container ugb-container ugb-7d8134d ugb-container--v2 ugb-container--design-basic ugb-main-block ugb--has-custom-content-width" id=""><style>.ugb-7d8134d-wrapper.ugb-container__wrapper{padding-top:0 !important;padding-bottom:0 !important;background-color:#edd09a !important}.ugb-7d8134d-wrapper > .ugb-container__side{padding-top:35px !important;padding-bottom:35px !important}.ugb-7d8134d-wrapper.ugb-container__wrapper:before{background-color:#edd09a !important}.ugb-7d8134d-content-wrapper > h1,.ugb-7d8134d-content-wrapper > h2,.ugb-7d8134d-content-wrapper > h3,.ugb-7d8134d-content-wrapper > h4,.ugb-7d8134d-content-wrapper > h5,.ugb-7d8134d-content-wrapper > h6{color:#222222}.ugb-7d8134d-content-wrapper > p,.ugb-7d8134d-content-wrapper > ol li,.ugb-7d8134d-content-wrapper > ul li{color:#222222}.ugb-7d8134d .ugb-inner-block{text-align:left}.ugb-7d8134d.ugb-container{justify-content:flex-start}.ugb-7d8134d.ugb-container > .ugb-inner-block{max-width:800px !important}@media screen and (min-width:768px){.ugb-7d8134d-content-wrapper.ugb-container__content-wrapper{width:100% !important}.ugb-7d8134d.ugb-container{padding-top:0px !important;padding-bottom:16px !important;padding-left:0px !important}}</style><div class="ugb-inner-block"><div class="ugb-block-content"><div class="ugb-container__wrapper ugb-7d8134d-wrapper"><div class="ugb-container__side"><div class="ugb-container__content-wrapper ugb-7d8134d-content-wrapper">
<figure class="wp-block-gallery columns-3">- <figure>![](http://daughtrey.com/wp-content/uploads/2020/10/underbite-150x150.jpg)</figure>
- <figure>![](http://daughtrey.com/wp-content/uploads/2020/10/snarl-150x150.jpg)</figure>
- <figure>![](http://daughtrey.com/wp-content/uploads/2020/10/smile-150x150.jpg)</figure>
- <figure>![](http://daughtrey.com/wp-content/uploads/2020/10/overbite-150x150.jpg)</figure>
- <figure>![](http://daughtrey.com/wp-content/uploads/2020/10/hackaday-150x150.jpg)</figure>
- <figure>![](http://daughtrey.com/wp-content/uploads/2020/10/gritted-150x150.jpg)</figure>

</figure>## A mask-mounted e-paper display, controlled from your phone.

</div></div></div></div></div></div><div class="aligncenter wp-block-ugb-container ugb-container ugb-7838a98 ugb-container--v2 ugb-container--design-basic ugb-main-block ugb--has-custom-content-width" id=""><style>.ugb-7838a98-wrapper.ugb-container__wrapper{padding-top:0 !important;padding-bottom:0 !important;background-color:#edd09a !important}.ugb-7838a98-wrapper > .ugb-container__side{padding-top:35px !important;padding-bottom:35px !important}.ugb-7838a98-wrapper.ugb-container__wrapper:before{background-color:#edd09a !important}.ugb-7838a98-content-wrapper > h1,.ugb-7838a98-content-wrapper > h2,.ugb-7838a98-content-wrapper > h3,.ugb-7838a98-content-wrapper > h4,.ugb-7838a98-content-wrapper > h5,.ugb-7838a98-content-wrapper > h6{color:#222222}.ugb-7838a98-content-wrapper > p,.ugb-7838a98-content-wrapper > ol li,.ugb-7838a98-content-wrapper > ul li{color:#222222}.ugb-7838a98 .ugb-inner-block{text-align:left}.ugb-7838a98.ugb-container{justify-content:flex-start}.ugb-7838a98.ugb-container > .ugb-inner-block{max-width:800px !important}@media screen and (min-width:768px){.ugb-7838a98-content-wrapper.ugb-container__content-wrapper{width:100% !important}.ugb-7838a98.ugb-container{margin-top:0% !important;margin-bottom:0% !important;margin-right:0% !important;margin-left:0% !important;padding-top:0px !important;padding-bottom:0px !important;padding-left:0px !important}}</style><div class="ugb-inner-block"><div class="ugb-block-content"><div class="ugb-container__wrapper ugb-7838a98-wrapper"><div class="ugb-container__side"><div class="ugb-container__content-wrapper ugb-7838a98-content-wrapper"><div class="wp-block-image is-style-rounded"><figure class="alignleft size-large is-resized">![](http://daughtrey.com/wp-content/uploads/2020/10/underbite.jpg)</figure></div><div class="wp-block-ugb-container ugb-container ugb-b5d6837 ugb-container--v2 ugb-container--design-plain ugb-main-block ugb--has-custom-content-width" id=""><style>.ugb-b5d6837 .ugb-inner-block{text-align:left}.ugb-b5d6837.ugb-container{justify-content:flex-end}.ugb-b5d6837.ugb-container > .ugb-inner-block{max-width:2500px !important}@media screen and (min-width:768px){.ugb-b5d6837-content-wrapper.ugb-container__content-wrapper{width:100% !important}.ugb-b5d6837.ugb-container{padding-top:0px !important;padding-right:0px !important;padding-bottom:0px !important;padding-left:40px !important}}</style><div class="ugb-inner-block"><div class="ugb-block-content"><div class="ugb-container__wrapper ugb-b5d6837-wrapper"><div class="ugb-container__side"><div class="ugb-container__content-wrapper ugb-b5d6837-content-wrapper">## Mask Construction

<div class="wp-block-ugb-container ugb-container ugb-5161688 ugb-container--v2 ugb-container--design-plain ugb-main-block" id=""><style>@media screen and (min-width:768px){.ugb-5161688.ugb-container{padding-top:0px !important;padding-right:0px !important;padding-bottom:0px !important;padding-left:0px !important}}</style><div class="ugb-inner-block"><div class="ugb-block-content"><div class="ugb-container__wrapper ugb-5161688-wrapper"><div class="ugb-container__side"><div class="ugb-container__content-wrapper ugb-5161688-content-wrapper">A fairly simple design done in [OpenSCAD](http://www.openscad.org/). Itâ€™s two parts; The cyan clip fits over the yellow assembly. The parts are printed in PLA so I glued the two parts together with dichloromethane solvent (available as [Scigrip 16](https://www.amazon.com/s?k=scigrip+16&crid=1GZGEW2J5Q9K3&sprefix=scigrip%2Caps%2C133&ref=nb_sb_ss_i_2_7) at Amazon) and then cut the mask fabric out. The design file is [here](https://github.com/mdaughtrey/openscad/blob/master/bluemouth/bluemouth.scad)

</div></div></div></div></div></div><figure class="wp-block-image size-medium">![](http://daughtrey.com/wp-content/uploads/2020/10/image-300x217.png)</figure></div></div></div></div></div></div></div></div></div></div></div></div><div class="aligncenter wp-block-ugb-container ugb-container ugb-5c7d653 ugb-container--v2 ugb-container--design-basic ugb-main-block ugb--has-custom-content-width" id=""><style>.ugb-5c7d653-wrapper.ugb-container__wrapper{padding-top:0 !important;padding-bottom:0 !important;background-color:#edd09a !important}.ugb-5c7d653-wrapper > .ugb-container__side{padding-top:35px !important;padding-bottom:35px !important}.ugb-5c7d653-wrapper.ugb-container__wrapper:before{background-color:#edd09a !important}.ugb-5c7d653-content-wrapper > h1,.ugb-5c7d653-content-wrapper > h2,.ugb-5c7d653-content-wrapper > h3,.ugb-5c7d653-content-wrapper > h4,.ugb-5c7d653-content-wrapper > h5,.ugb-5c7d653-content-wrapper > h6{color:#222222}.ugb-5c7d653-content-wrapper > p,.ugb-5c7d653-content-wrapper > ol li,.ugb-5c7d653-content-wrapper > ul li{color:#222222}.ugb-5c7d653 .ugb-inner-block{text-align:left}.ugb-5c7d653.ugb-container{justify-content:flex-start}.ugb-5c7d653.ugb-container > .ugb-inner-block{max-width:800px !important}@media screen and (min-width:768px){.ugb-5c7d653.ugb-container{padding-top:0px !important;padding-right:0px !important;padding-bottom:0px !important;padding-left:0px !important}}</style><div class="ugb-inner-block"><div class="ugb-block-content"><div class="ugb-container__wrapper ugb-5c7d653-wrapper"><div class="ugb-container__side"><div class="ugb-container__content-wrapper ugb-5c7d653-content-wrapper"><div class="wp-block-image is-style-rounded"><figure class="alignleft size-large is-resized">![](http://daughtrey.com/wp-content/uploads/2020/10/snarl.jpg)</figure></div><div class="wp-block-ugb-container ugb-container ugb-9325d5a ugb-container--v2 ugb-container--design-plain ugb-main-block" id=""><style>.ugb-9325d5a .ugb-inner-block{text-align:left}@media screen and (min-width:768px){.ugb-9325d5a.ugb-container{padding-left:40px !important}}</style><div class="ugb-inner-block"><div class="ugb-block-content"><div class="ugb-container__wrapper ugb-9325d5a-wrapper"><div class="ugb-container__side"><div class="ugb-container__content-wrapper ugb-9325d5a-content-wrapper">## Display Installation

Here is the mounted e-paper display with an adapter board also acting as strain relief:.

<figure class="wp-block-image size-medium">![](http://daughtrey.com/wp-content/uploads/2020/10/mounted-1-233x300.jpg)</figure></div></div></div></div></div></div></div></div></div></div></div></div><div class="wp-block-ugb-container ugb-container ugb-2cba3f3 ugb-container--v2 ugb-container--design-basic ugb-main-block ugb--has-custom-content-width" id=""><style>.ugb-2cba3f3-wrapper.ugb-container__wrapper{padding-top:0 !important;padding-bottom:0 !important;background-color:#edd09a !important}.ugb-2cba3f3-wrapper > .ugb-container__side{padding-top:35px !important;padding-bottom:35px !important}.ugb-2cba3f3-wrapper.ugb-container__wrapper:before{background-color:#edd09a !important}.ugb-2cba3f3-content-wrapper > h1,.ugb-2cba3f3-content-wrapper > h2,.ugb-2cba3f3-content-wrapper > h3,.ugb-2cba3f3-content-wrapper > h4,.ugb-2cba3f3-content-wrapper > h5,.ugb-2cba3f3-content-wrapper > h6{color:#222222}.ugb-2cba3f3-content-wrapper > p,.ugb-2cba3f3-content-wrapper > ol li,.ugb-2cba3f3-content-wrapper > ul li{color:#222222}.ugb-2cba3f3 .ugb-inner-block{text-align:left}.ugb-2cba3f3.ugb-container{justify-content:flex-start}.ugb-2cba3f3.ugb-container > .ugb-inner-block{max-width:800px !important}</style><div class="ugb-inner-block"><div class="ugb-block-content"><div class="ugb-container__wrapper ugb-2cba3f3-wrapper"><div class="ugb-container__side"><div class="ugb-container__content-wrapper ugb-2cba3f3-content-wrapper"><div class="wp-block-image is-style-rounded"><figure class="alignleft size-large is-resized">![](http://daughtrey.com/wp-content/uploads/2020/10/smile.jpg)</figure></div><div class="wp-block-ugb-container ugb-container ugb-1db21f8 ugb-container--v2 ugb-container--design-plain ugb-main-block" id=""><style>.ugb-1db21f8 .ugb-inner-block{text-align:left}@media screen and (min-width:768px){.ugb-1db21f8.ugb-container{padding-left:40px !important}}</style><div class="ugb-inner-block"><div class="ugb-block-content"><div class="ugb-container__wrapper ugb-1db21f8-wrapper"><div class="ugb-container__side"><div class="ugb-container__content-wrapper ugb-1db21f8-content-wrapper">## E-Paper Display and Driver

The e-paper display is a 2.9inch flexible display from [Waveshare ](https://www.waveshare.com/product/displays/e-paper/epaper-2/2.9inch-e-paper-d.htm)and [Aliexpress](https://www.aliexpress.com/item/32922604788.html?spm=a2g0o.productlist.0.0.798f72759DOwkb&algo_pvid=0bf8d789-ec06-4d99-8209-729a705f2530&algo_expid=0bf8d789-ec06-4d99-8209-729a705f2530-0&btsid=0bb0624216031648794658905e68db&ws_ab_test=searchweb0_0,searchweb201602_,searchweb201603_)

That connects to an ESP32 E-Paper driver board ([Aliexpress](https://www.aliexpress.com/item/4000804064988.html?spm=a2g0s.9042311.0.0.148b4c4dXyq1Qj)). Itâ€™s an ESP32-WROOM-32 module with connector hardware.

<figure class="wp-block-image size-medium">![](http://daughtrey.com/wp-content/uploads/2020/10/esp32-300x283.jpg)</figure></div></div></div></div></div></div></div></div></div></div></div></div><div class="wp-block-ugb-container ugb-container ugb-14564c9 ugb-container--v2 ugb-container--design-basic ugb-main-block ugb--has-custom-content-width" id=""><style>.ugb-14564c9-wrapper.ugb-container__wrapper{background-color:#edd09a !important}.ugb-14564c9-wrapper.ugb-container__wrapper:before{background-color:#edd09a !important}.ugb-14564c9-content-wrapper > h1,.ugb-14564c9-content-wrapper > h2,.ugb-14564c9-content-wrapper > h3,.ugb-14564c9-content-wrapper > h4,.ugb-14564c9-content-wrapper > h5,.ugb-14564c9-content-wrapper > h6{color:#222222}.ugb-14564c9-content-wrapper > p,.ugb-14564c9-content-wrapper > ol li,.ugb-14564c9-content-wrapper > ul li{color:#222222}.ugb-14564c9 .ugb-inner-block{text-align:left}.ugb-14564c9.ugb-container{justify-content:flex-start}.ugb-14564c9.ugb-container > .ugb-inner-block{max-width:800px !important}</style><div class="ugb-inner-block"><div class="ugb-block-content"><div class="ugb-container__wrapper ugb-14564c9-wrapper"><div class="ugb-container__side"><div class="ugb-container__content-wrapper ugb-14564c9-content-wrapper"><div class="wp-block-image is-style-rounded"><figure class="alignleft size-large is-resized">![](http://daughtrey.com/wp-content/uploads/2020/10/overbite.jpg)</figure></div><div class="wp-block-ugb-container ugb-container ugb-b6c02e2 ugb-container--v2 ugb-container--design-plain ugb-main-block" id=""><style>@media screen and (min-width:768px){.ugb-b6c02e2.ugb-container{padding-left:40px !important}}</style><div class="ugb-inner-block"><div class="ugb-block-content"><div class="ugb-container__wrapper ugb-b6c02e2-wrapper"><div class="ugb-container__side"><div class="ugb-container__content-wrapper ugb-b6c02e2-content-wrapper">## Image Preparation

The e-paper display is 296 x 128. I couldnâ€™t find any mouth images I liked on the net and I canâ€™t draw mouths, so I took a picture of my own face, cropped my mouth and drew around it, then saved the result as a 1 bit BMP. Iâ€™ll spare you the original image, but hereâ€™s a processed example:

<figure class="wp-block-image size-large">![](http://daughtrey.com/wp-content/uploads/2020/10/overbiteR.jpg)</figure></div></div></div></div></div></div></div></div></div></div></div></div><div class="wp-block-ugb-container ugb-container ugb-b1a6ea1 ugb-container--v2 ugb-container--design-basic ugb-main-block ugb--has-custom-content-width" id=""><style>.ugb-b1a6ea1-wrapper.ugb-container__wrapper{background-color:#f1d9a7 !important}.ugb-b1a6ea1-wrapper.ugb-container__wrapper:before{background-color:#f1d9a7 !important}.ugb-b1a6ea1-content-wrapper > h1,.ugb-b1a6ea1-content-wrapper > h2,.ugb-b1a6ea1-content-wrapper > h3,.ugb-b1a6ea1-content-wrapper > h4,.ugb-b1a6ea1-content-wrapper > h5,.ugb-b1a6ea1-content-wrapper > h6{color:#222222}.ugb-b1a6ea1-content-wrapper > p,.ugb-b1a6ea1-content-wrapper > ol li,.ugb-b1a6ea1-content-wrapper > ul li{color:#222222}.ugb-b1a6ea1.ugb-container{justify-content:flex-start}.ugb-b1a6ea1.ugb-container > .ugb-inner-block{max-width:800px !important}</style><div class="ugb-inner-block"><div class="ugb-block-content"><div class="ugb-container__wrapper ugb-b1a6ea1-wrapper"><div class="ugb-container__side"><div class="ugb-container__content-wrapper ugb-b1a6ea1-content-wrapper">**Once thatâ€™s done the image needs to be converted into a form suitable for inclusion into the code, and thatâ€™s done with a simple python script**

```
<pre class="wp-block-code">```
#!/usr/bin/env python3

import os.path
import pdb
import sys
import scipy
from PIL import Image as PILImage 
from PIL import ImageOps

def main():
    if len(sys.argv) == 1:
        print("need a picture")
        return 1

    filename = sys.argv[1]
    base = os.path.basename(filename).split('.')[0]
    img = PILImage.open(filename).convert('L')
    img = ImageOps.invert(img)
    img = img.convert('1')

    img.save("{}_1bit.bmp".format(base))
    dd = ','.join([hex(~x &amp; 0xff) for x in img.tobytes()])
    open('{}.h'.format(base),'w').write('const unsigned char {}_data[] = {{{}}};\n'.format(base, dd))

main()

```
```

**Then I copy the generated header files into the ESP32 environment and bind them in**.

</div></div></div></div></div></div><div class="wp-block-ugb-container ugb-container ugb-f701bec ugb-container--v2 ugb-container--design-basic ugb-main-block ugb--has-custom-content-width" id=""><style>.ugb-f701bec-wrapper.ugb-container__wrapper{background-color:#f1d9a7 !important}.ugb-f701bec-wrapper.ugb-container__wrapper:before{background-color:#f1d9a7 !important}.ugb-f701bec-content-wrapper > h1,.ugb-f701bec-content-wrapper > h2,.ugb-f701bec-content-wrapper > h3,.ugb-f701bec-content-wrapper > h4,.ugb-f701bec-content-wrapper > h5,.ugb-f701bec-content-wrapper > h6{color:#222222}.ugb-f701bec-content-wrapper > p,.ugb-f701bec-content-wrapper > ol li,.ugb-f701bec-content-wrapper > ul li{color:#222222}.ugb-f701bec.ugb-container{justify-content:flex-start}.ugb-f701bec.ugb-container > .ugb-inner-block{max-width:800px !important}</style><div class="ugb-inner-block"><div class="ugb-block-content"><div class="ugb-container__wrapper ugb-f701bec-wrapper"><div class="ugb-container__side"><div class="ugb-container__content-wrapper ugb-f701bec-content-wrapper"><div class="wp-block-image is-style-rounded"><figure class="alignleft size-large is-resized">![](http://daughtrey.com/wp-content/uploads/2020/10/hackaday.jpg)</figure></div><div class="wp-block-ugb-container ugb-container ugb-ed9facf ugb-container--v2 ugb-container--design-plain ugb-main-block" id=""><style>.ugb-ed9facf .ugb-inner-block{text-align:left}@media screen and (min-width:768px){.ugb-ed9facf.ugb-container{padding-left:40px !important}}</style><div class="ugb-inner-block"><div class="ugb-block-content"><div class="ugb-container__wrapper ugb-ed9facf-wrapper"><div class="ugb-container__side"><div class="ugb-container__content-wrapper ugb-ed9facf-content-wrapper">## ESP32 Software

The code is a mixture of the BLE client sample code that comes with the BLE library, the proof of concept code for the e-paper display, and my own logic. I would have like to use the [GxEPD2 ](https://github.com/ZinggJM/GxEPD2)library but it doesnâ€™t yet support my display. Instead Iâ€™ve hacked up the [sample code from github](https://github.com/waveshare/e-Paper/tree/master/Arduino). The screen refresh is pretty rough still.

I used arduino-cli in a Docker container to develop the ESP32 code. The code is [here](https://github.com/mdaughtrey/personal-projects/tree/master/arduino/arduino-cli/eink/bluemouth/bluemouth)

</div></div></div></div></div></div></div></div></div></div></div></div><div class="wp-block-ugb-container ugb-container ugb-39a3e30 ugb-container--v2 ugb-container--design-basic ugb-main-block ugb--has-custom-content-width" id=""><style>.ugb-39a3e30-wrapper.ugb-container__wrapper{background-color:#f1d9a7 !important}.ugb-39a3e30-wrapper.ugb-container__wrapper:before{background-color:#f1d9a7 !important}.ugb-39a3e30-content-wrapper > h1,.ugb-39a3e30-content-wrapper > h2,.ugb-39a3e30-content-wrapper > h3,.ugb-39a3e30-content-wrapper > h4,.ugb-39a3e30-content-wrapper > h5,.ugb-39a3e30-content-wrapper > h6{color:#222222}.ugb-39a3e30-content-wrapper > p,.ugb-39a3e30-content-wrapper > ol li,.ugb-39a3e30-content-wrapper > ul li{color:#222222}.ugb-39a3e30 .ugb-inner-block{text-align:left}.ugb-39a3e30.ugb-container{justify-content:flex-start}.ugb-39a3e30.ugb-container > .ugb-inner-block{max-width:800px !important}</style><div class="ugb-inner-block"><div class="ugb-block-content"><div class="ugb-container__wrapper ugb-39a3e30-wrapper"><div class="ugb-container__side"><div class="ugb-container__content-wrapper ugb-39a3e30-content-wrapper"><div class="wp-block-image is-style-rounded"><figure class="alignleft size-large is-resized">![](http://daughtrey.com/wp-content/uploads/2020/10/gritted.jpg)</figure></div><div class="wp-block-ugb-container ugb-container ugb-1521673 ugb-container--v2 ugb-container--design-plain ugb-main-block" id=""><style>@media screen and (min-width:768px){.ugb-1521673.ugb-container{padding-left:40px !important}}</style><div class="ugb-inner-block"><div class="ugb-block-content"><div class="ugb-container__wrapper ugb-1521673-wrapper"><div class="ugb-container__side"><div class="ugb-container__content-wrapper ugb-1521673-content-wrapper">## Phone Control Javascript

The ESP32 module runs as a Bluetooth Low Energy (BLE) client. This allows control from the phone. The phone app is written using [phonk.app](https://phonk.app/), which allows most of the phone functions to be accessed using Javascript. This system is a work in progress but itâ€™s very useful already.  
The communication between the phone and the ESP32 is a simple serial command interface; the ESP responds to a set of simple commands and displays the selected image.

<div class="wp-block-image"><figure class="alignright size-medium is-resized">![](http://daughtrey.com/wp-content/uploads/2020/10/phonk-2-146x300.png)</figure></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="wp-block-ugb-container ugb-container ugb-74ab2c1 ugb-container--v2 ugb-container--design-basic ugb-main-block" id=""><style>.ugb-74ab2c1-wrapper.ugb-container__wrapper{background-color:#f1d9a7 !important}.ugb-74ab2c1-wrapper > .ugb-container__side{align-items:flex-start !important}.ugb-74ab2c1-wrapper.ugb-container__wrapper:before{background-color:#f1d9a7 !important}.ugb-74ab2c1-content-wrapper > h1,.ugb-74ab2c1-content-wrapper > h2,.ugb-74ab2c1-content-wrapper > h3,.ugb-74ab2c1-content-wrapper > h4,.ugb-74ab2c1-content-wrapper > h5,.ugb-74ab2c1-content-wrapper > h6{color:#222222}.ugb-74ab2c1-content-wrapper > p,.ugb-74ab2c1-content-wrapper > ol li,.ugb-74ab2c1-content-wrapper > ul li{color:#222222}@media screen and (min-width:768px){.ugb-74ab2c1-content-wrapper.ugb-container__content-wrapper{width:100% !important}}</style><div class="ugb-inner-block"><div class="ugb-block-content"><div class="ugb-container__wrapper ugb-74ab2c1-wrapper"><div class="ugb-container__side"><div class="ugb-container__content-wrapper ugb-74ab2c1-content-wrapper">## The phone code:

```
<pre class="wp-block-code">```
ui.addTitle('BlueMouth')

network.bluetoothLE.start()
var bleClient = network.bluetoothLE.createClient()

// -> Write here the BLE device MAC Address
// var deviceMacAddress = '24:6F:28:7A:5C:CE'
var deviceMacAddress = '4C:11:AE:79:8E:8A';
var serviceUUID = '6E400001-B5A3-F393-E0A9-E50E24DCCA9E'
var characteristicUUID_TX = '6e400002-b5a3-f393-e0a9-e50e24dcca9e'
var characteristicUUID_RX = '6e400003-b5a3-f393-e0a9-e50e24dcca9e'

function setResources(data)
{
var list = ui.addList(0.1, 0.1, 0.85, 0.8).init(
  data,
  function () { // on create view`
    return ui.newView('button')
  },
  function (o) { // data binding
    var t = data[o.position]
    o.view.props.background = '#00FFFFFF'
    o.view.props.padding = 50
    o.view.text(t)
    o.view.onClick(function () {
      bleClient.write(t, deviceMacAddress, serviceUUID, characteristicUUID_TX)
    }
  )
  })}
  
network.bluetoothLE.start()
// scan bluetooth low energy networks
// this should show devices -> services -> characteristics
var btn = ui.addButton('Get', 0.1, 0.9, 0.4, 0.1).onClick(function () {
      bleClient.write("list", deviceMacAddress, serviceUUID, characteristicUUID_TX)
})

// connect to a device
ui.addToggle(['Connect', 'Disconnect'], 0.55, 0.9, 0.4, 0.1).onChange(function (e) {
  if (e.checked) {
    bleClient.connectDevice(deviceMacAddress)
  } else {
    bleClient.disconnectDevice(deviceMacAddress)
  }
})

bleClient.onNewDeviceStatus(function (e) {
  // double check if is the device we want to connect
  if (e.deviceMac === deviceMacAddress && e.status === 'connected') {
    bleClient.readFromCharacteristic(deviceMacAddress, serviceUUID, characteristicUUID_RX)
    //txt.add('connected to ' + e.deviceName)
  }
})

bleClient.onNewData(function (e) {
  console.log("newData");
  var value = util.parseBytes(e.value, 'string')
  elems = value.split(',')
  if ("list" == elems[0])
  {
    setResources(elems.slice(1,))
  }
})

```
```

</div></div></div></div></div></div>
