



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Q for Mortals">
      
      
        <link rel="canonical" href="index.html">
      
      
        <meta name="author" content="Jeffry Borror">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../img/favicon.ico">
      <meta name="generator" content="mkdocs-0.17.3, mkdocs-material-2.7.2">
    
    
      
        <title>7. Transforming Data - Q for Mortals</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.8d40d89b.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.6079476c.css">
      
    
    
      <script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
      <link rel="stylesheet" href="http://code.kx.com/stylesheets/prism.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="blue" data-md-color-accent="deep-orange">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="index.html#7-transforming-data" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="http://code.kx.com/q4m3" title="Q for Mortals" class="md-header-nav__button md-logo">
          
            <img src="../img/qfm3.jpg" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Q for Mortals
              </span>
              <span class="md-header-nav__topic">
                7. Transforming Data
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../img/qfm3.jpg" width="48" height="48">
      
    </span>
    Q for Mortals
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../redirect/index.html" title="code.kx.com" class="md-nav__link">
      code.kx.com
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../index.html" title="Contents" class="md-nav__link">
      Contents
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../preface/index.html" title="Preface" class="md-nav__link">
      Preface
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../0_Overview/index.html" title="0. Overview" class="md-nav__link">
      0. Overview
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../1_Q_Shock_and_Awe.1" title="1. Q Shock and Awe" class="md-nav__link">
      1. Q Shock and Awe
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../2_Basic_Data_Types_Atoms/index.html" title="2. Basic Data Types – Atoms" class="md-nav__link">
      2. Basic Data Types – Atoms
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../3_Lists.1" title="3. Lists" class="md-nav__link">
      3. Lists
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../4_Operators.1" title="4. Operators" class="md-nav__link">
      4. Operators
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../5_Dictionaries.1" title="5. Dictionaries" class="md-nav__link">
      5. Dictionaries
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../6_Functions.1" title="6. Functions" class="md-nav__link">
      6. Functions
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        7. Transforming Data
      </label>
    
    <a href="index.html" title="7. Transforming Data" class="md-nav__link md-nav__link--active">
      7. Transforming Data
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="index.html#71-types" title="7.1 Types" class="md-nav__link">
    7.1 Types
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="index.html#711-basic-datatypes" title="7.1.1 Basic DataTypes" class="md-nav__link">
    7.1.1 Basic DataTypes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#712-the-type-operator" title="7.1.2 The type Operator" class="md-nav__link">
    7.1.2 The type Operator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#713-type-of-a-variable" title="7.1.3 Type of a Variable" class="md-nav__link">
    7.1.3 Type of a Variable
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#72-cast" title="7.2 Cast" class="md-nav__link">
    7.2 Cast
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="index.html#721-casts-that-widen" title="7.2.1 Casts that Widen" class="md-nav__link">
    7.2.1 Casts that Widen
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#722-casts-across-disparate-types" title="7.2.2 Casts across Disparate Types" class="md-nav__link">
    7.2.2 Casts across Disparate Types
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#723-casts-that-narrow" title="7.2.3 Casts that Narrow" class="md-nav__link">
    7.2.3 Casts that Narrow
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#724-casting-integral-infinities" title="7.2.4 Casting Integral Infinities" class="md-nav__link">
    7.2.4 Casting Integral Infinities
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#725-coercing-types" title="7.2.5 Coercing Types" class="md-nav__link">
    7.2.5 Coercing Types
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#726-cast-is-atomic" title="7.2.6 Cast is Atomic" class="md-nav__link">
    7.2.6 Cast is Atomic
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#73-data-to-and-from-text" title="7.3 Data to and from Text" class="md-nav__link">
    7.3 Data to and from Text
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="index.html#731-data-to-strings" title="7.3.1 Data to Strings" class="md-nav__link">
    7.3.1 Data to Strings
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#732-creating-symbols-from-strings" title="7.3.2 Creating Symbols from Strings" class="md-nav__link">
    7.3.2 Creating Symbols from Strings
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#733-parsing-data-from-strings" title="7.3.3 Parsing Data from Strings" class="md-nav__link">
    7.3.3 Parsing Data from Strings
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#74-creating-typed-empty-lists" title="7.4 Creating Typed Empty Lists" class="md-nav__link">
    7.4 Creating Typed Empty Lists
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#75-enumerations" title="7.5 Enumerations" class="md-nav__link">
    7.5 Enumerations
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="index.html#751-traditional-enumerations" title="7.5.1 Traditional Enumerations" class="md-nav__link">
    7.5.1 Traditional Enumerations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#752-data-normalization" title="7.5.2 Data Normalization" class="md-nav__link">
    7.5.2 Data Normalization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#753-enumerating-symbols" title="7.5.3 Enumerating Symbols" class="md-nav__link">
    7.5.3 Enumerating Symbols
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#754-using-enumerated-symbols" title="7.5.4 Using Enumerated Symbols" class="md-nav__link">
    7.5.4 Using Enumerated Symbols
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#755-type-of-enumerations" title="7.5.5 Type of Enumerations" class="md-nav__link">
    7.5.5 Type of Enumerations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#756-updating-an-enumerated-list" title="7.5.6 Updating an Enumerated List" class="md-nav__link">
    7.5.6 Updating an Enumerated List
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#757-dynamically-appending-to-an-enumeration-domain" title="7.5.7 Dynamically Appending to an Enumeration Domain" class="md-nav__link">
    7.5.7 Dynamically Appending to an Enumeration Domain
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#758-resolving-an-enumeration" title="7.5.8 Resolving an Enumeration" class="md-nav__link">
    7.5.8 Resolving an Enumeration
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../8_Tables.1" title="8. Tables" class="md-nav__link">
      8. Tables
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../9_Queries_q-sql.1" title="9. Queries – q-sql" class="md-nav__link">
      9. Queries – q-sql
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../10_Execution_Control/index.html" title="10. Execution Control" class="md-nav__link">
      10. Execution Control
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../11_IO.1" title="11. I/O" class="md-nav__link">
      11. I/O
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../12_Workspace_Organization.1" title="12. Workspace Organization" class="md-nav__link">
      12. Workspace Organization
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../13_Commands_and_System_Variables.1" title="13. Commands and System Variables" class="md-nav__link">
      13. Commands and System Variables
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../14_Introduction_to_Kdb+.1" title="14. Introduction to Kdb+" class="md-nav__link">
      14. Introduction to Kdb+
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../A_Built-in_Functions.1" title="Appendix A. Built-in Functions" class="md-nav__link">
      Appendix A. Built-in Functions
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../B_Error_Messages/index.html" title="Appendix B. Error Messages" class="md-nav__link">
      Appendix B. Error Messages
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../colophon/index.html" title="Colophon" class="md-nav__link">
      Colophon
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="index.html#71-types" title="7.1 Types" class="md-nav__link">
    7.1 Types
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="index.html#711-basic-datatypes" title="7.1.1 Basic DataTypes" class="md-nav__link">
    7.1.1 Basic DataTypes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#712-the-type-operator" title="7.1.2 The type Operator" class="md-nav__link">
    7.1.2 The type Operator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#713-type-of-a-variable" title="7.1.3 Type of a Variable" class="md-nav__link">
    7.1.3 Type of a Variable
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#72-cast" title="7.2 Cast" class="md-nav__link">
    7.2 Cast
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="index.html#721-casts-that-widen" title="7.2.1 Casts that Widen" class="md-nav__link">
    7.2.1 Casts that Widen
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#722-casts-across-disparate-types" title="7.2.2 Casts across Disparate Types" class="md-nav__link">
    7.2.2 Casts across Disparate Types
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#723-casts-that-narrow" title="7.2.3 Casts that Narrow" class="md-nav__link">
    7.2.3 Casts that Narrow
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#724-casting-integral-infinities" title="7.2.4 Casting Integral Infinities" class="md-nav__link">
    7.2.4 Casting Integral Infinities
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#725-coercing-types" title="7.2.5 Coercing Types" class="md-nav__link">
    7.2.5 Coercing Types
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#726-cast-is-atomic" title="7.2.6 Cast is Atomic" class="md-nav__link">
    7.2.6 Cast is Atomic
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#73-data-to-and-from-text" title="7.3 Data to and from Text" class="md-nav__link">
    7.3 Data to and from Text
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="index.html#731-data-to-strings" title="7.3.1 Data to Strings" class="md-nav__link">
    7.3.1 Data to Strings
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#732-creating-symbols-from-strings" title="7.3.2 Creating Symbols from Strings" class="md-nav__link">
    7.3.2 Creating Symbols from Strings
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#733-parsing-data-from-strings" title="7.3.3 Parsing Data from Strings" class="md-nav__link">
    7.3.3 Parsing Data from Strings
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#74-creating-typed-empty-lists" title="7.4 Creating Typed Empty Lists" class="md-nav__link">
    7.4 Creating Typed Empty Lists
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#75-enumerations" title="7.5 Enumerations" class="md-nav__link">
    7.5 Enumerations
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="index.html#751-traditional-enumerations" title="7.5.1 Traditional Enumerations" class="md-nav__link">
    7.5.1 Traditional Enumerations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#752-data-normalization" title="7.5.2 Data Normalization" class="md-nav__link">
    7.5.2 Data Normalization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#753-enumerating-symbols" title="7.5.3 Enumerating Symbols" class="md-nav__link">
    7.5.3 Enumerating Symbols
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#754-using-enumerated-symbols" title="7.5.4 Using Enumerated Symbols" class="md-nav__link">
    7.5.4 Using Enumerated Symbols
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#755-type-of-enumerations" title="7.5.5 Type of Enumerations" class="md-nav__link">
    7.5.5 Type of Enumerations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#756-updating-an-enumerated-list" title="7.5.6 Updating an Enumerated List" class="md-nav__link">
    7.5.6 Updating an Enumerated List
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#757-dynamically-appending-to-an-enumeration-domain" title="7.5.7 Dynamically Appending to an Enumeration Domain" class="md-nav__link">
    7.5.7 Dynamically Appending to an Enumeration Domain
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#758-resolving-an-enumeration" title="7.5.8 Resolving an Enumeration" class="md-nav__link">
    7.5.8 Resolving an Enumeration
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="7-transforming-data">7. Transforming Data<a class="headerlink" href="index.html#7-transforming-data" title="Permanent link">&para;</a></h1>
<h2 id="71-types">7.1 Types<a class="headerlink" href="index.html#71-types" title="Permanent link">&para;</a></h2>
<p>Casting is a way to convert a value of one type to a compatible type. Sometimes the conversion is exact; other times information is lost. Enumeration and parsing in q also fit into the cast pattern.</p>
<h3 id="711-basic-datatypes">7.1.1 Basic DataTypes<a class="headerlink" href="index.html#711-basic-datatypes" title="Permanent link">&para;</a></h3>
<p>A type can be specified in three equivalent ways: a char, a short and a symbol. For convenience, we repeat the data types table from Chapter 1.</p>
<table>
<thead>
<tr>
<th>type</th>
<th>type symbol</th>
<th>type char</th>
<th>type num</th>
</tr>
</thead>
<tbody>
<tr>
<td>boolean</td>
<td>`boolean</td>
<td>B</td>
<td>1h</td>
</tr>
<tr>
<td>guid</td>
<td>`guid</td>
<td>G</td>
<td>2h</td>
</tr>
<tr>
<td>byte</td>
<td>`byte</td>
<td>X</td>
<td>4h</td>
</tr>
<tr>
<td>short</td>
<td>`short</td>
<td>H</td>
<td>5h</td>
</tr>
<tr>
<td>int</td>
<td>`int</td>
<td>I</td>
<td>6h</td>
</tr>
<tr>
<td>long</td>
<td>`long</td>
<td>J</td>
<td>7h</td>
</tr>
<tr>
<td>real</td>
<td>`real</td>
<td>E</td>
<td>8h</td>
</tr>
<tr>
<td>float</td>
<td>`float</td>
<td>F</td>
<td>9h</td>
</tr>
<tr>
<td>char</td>
<td>`char</td>
<td>C</td>
<td>10h</td>
</tr>
<tr>
<td>symbol</td>
<td>`</td>
<td>S</td>
<td>11h</td>
</tr>
<tr>
<td>timestamp</td>
<td>`timestamp</td>
<td>P</td>
<td>12h</td>
</tr>
<tr>
<td>month</td>
<td>`month</td>
<td>M</td>
<td>13h</td>
</tr>
<tr>
<td>date</td>
<td>`date</td>
<td>D</td>
<td>14h</td>
</tr>
<tr>
<td>datetime</td>
<td>`datetime</td>
<td>Z</td>
<td>15h</td>
</tr>
<tr>
<td>timespan</td>
<td>`timespan</td>
<td>N</td>
<td>16h</td>
</tr>
<tr>
<td>minute</td>
<td>`minute</td>
<td>U</td>
<td>17h</td>
</tr>
<tr>
<td>second</td>
<td>`second</td>
<td>V</td>
<td>18h</td>
</tr>
<tr>
<td>time</td>
<td>`time</td>
<td>T</td>
<td>19h</td>
</tr>
</tbody>
</table>
<h3 id="712-the-type-operator">7.1.2 The <code>type</code> Operator<a class="headerlink" href="index.html#712-the-type-operator" title="Permanent link">&para;</a></h3>
<p>The non-atomic monadic function (<code>type</code>) can be applied to any entity in q to return its data type expressed as a short. It is a "feature" of q that the data type of an atom is negative whereas the type of a simple list is positive.</p>
<pre><code class="q">q)type 42
-7h
q)type 10 20 30
7h
q)type 98.6
-9h
q)type 1.1 2.2 3.3
_
q)type `a
-11h
q)type `a`b`c
_
q)type &quot;z&quot;
-10h
q)type &quot;abc&quot;
_
</code></pre>

<p>Observe that infinities and nulls have their respective types.</p>
<pre><code class="q">q)type 0W
-7h
q)type 0N
_
q)type -0w
-9h
q)type 0n
_
q)type `
-11h
</code></pre>

<p>The type of any general list is <code>0</code>.</p>
<pre><code class="q">q)type (42h; 42i; 42j)
0h
q)type (1 2 3; 10 20 30)
_
q)type ()
_
</code></pre>

<p>The type of any dictionary, including a keyed table, is <code>99h</code>.</p>
<pre><code class="q">q)type (`a`b`c!10 20 30)
99h
q)type ([k:`a`b`c] v:10 20 30)
_
</code></pre>

<p>The type of any table is <code>98h</code>.</p>
<pre><code class="q">q)type ([] c1:`a`b`c; c2:10 20 30)
98h
</code></pre>

<h3 id="713-type-of-a-variable">7.1.3 Type of a Variable<a class="headerlink" href="index.html#713-type-of-a-variable" title="Permanent link">&para;</a></h3>
<p>Since q is a dynamically typed language, a variable has the type of the value currently assigned to it. Unlike statically typed languages, there is no predeclaration of type.</p>
<pre><code class="q">q)a:42
q)type a
-7h
q)a:&quot;abc&quot;
q)type a
10h
</code></pre>

<p>In more detail, the variable <code>a</code> above is an association between the name <code>`a</code> and its assigned value. Since this is the first time that the variable is assigned, the q interpreter creates an entry for the key <code>`a</code> in its dictionary of global variables and associates it with the value <code>42</code>.</p>
<pre><code class="q">q)get `.
a| 42
</code></pre>

<p>On the subsequent assignment, there is already an entry for the key <code>`a</code> in the dictionary, so the value <code>"abc"</code> is upserted.</p>
<pre><code class="q+">q)get `.
a| &quot;abc&quot;
</code></pre>

<p>The type of a variable <strong>is</strong> the type of the value associated with the variable's name.</p>
<p>Global variables are stored in ordinary q dictionaries with special names. For example, the symbol <code>`.</code> is the name of the default global dictionary. Start a fresh q session and observe the life of this dictionary using <code>value</code>.</p>
<pre><code class="q">q)value `.
q)a:42
q)value `.
a| 42
q)f:{x*x}
q)value `.
a| 42
f| {x*x}
..
</code></pre>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since q internally uses the same dictionary structures available to us, it has been said (crassly) that q eats its own dog food.</p>
</div>
<h2 id="72-cast">7.2 Cast<a class="headerlink" href="index.html#72-cast" title="Permanent link">&para;</a></h2>
<p>Casting renders an underlying value of one type into another compatible type. For example, a short integer has a natural interpretation as a long integer. In the Mathematical Refresher we discussed the implicit identifications of naturals with their rational counterparts and rationals with their repeating decimal real counterparts. These identifications are actually examples of casting, since the numeric values representing the different types are the same in essence.</p>
<p>Since q is dynamically typed, casting occurs at run-time using the dyadic operator <code>$</code>, which is atomic in both operands. The right operand is the source value and the left operand specifies the target type. There are three ways to specify the target type, indicated by the first three columns of the type table at the beginning of this chapter.</p>
<ul>
<li>A (positive) numeric short type value</li>
<li>A char type value</li>
<li>A type name symbol</li>
</ul>
<h3 id="721-casts-that-widen">7.2.1 Casts that Widen<a class="headerlink" href="index.html#721-casts-that-widen" title="Permanent link">&para;</a></h3>
<p>In these examples, no information is lost in the cast, as the target type is wider than the source type. Here are examples using the short type specification in the target.</p>
<pre><code class="q">q)7h$42i / int to long
42
q)6h$42 / long to int
42i
q)9h$42 / long to float
42f
</code></pre>

<p>It is arguably more readable to use the type char. Here are the same examples recast (ouch) to use the type char.</p>
<pre><code class="q">q)&quot;j&quot;$42i
42
q)&quot;i&quot;$42
42i
q)&quot;f&quot;$42
42f
</code></pre>

<p>It is arguably most readable to use the symbolic type name.</p>
<pre><code class="q">q)`int$42
_
q)`long$42i
_
q)`float$42
_
</code></pre>

<h3 id="722-casts-across-disparate-types">7.2.2 Casts across Disparate Types<a class="headerlink" href="index.html#722-casts-across-disparate-types" title="Permanent link">&para;</a></h3>
<p>It may come as a surprise that q allows casting between superficially disparate types. When the underlying values are the same, the types are essentially just different representation formats, so why not allow a cast? We use the symbolic names in the following examples; the other formats work equally well.</p>
<p>The underlying value of a char is its position in the ASCII collation sequence, so we can cast char to and from integers, provided the integer is less than 256.</p>
<pre><code class="q">q)`char$42
&quot;*&quot;
q)`long$&quot;\n&quot;
_
</code></pre>

<p>The underlying value of a date is its count of days from the millennium, so we can cast to and from an<code>int</code>.</p>
<pre><code class="q">q)`date$0
2000.01.01
q)`int$2001.01.01 / millennium occurred on leap year
_
</code></pre>

<p>The underlying value of a timespan is its count of nanoseconds from midnight, so we can cast it to and from long.</p>
<pre><code class="q">q)`long$12:00:00.0000000000
43200000000000
q)`timespan$0
_
</code></pre>

<h3 id="723-casts-that-narrow">7.2.3 Casts that Narrow<a class="headerlink" href="index.html#723-casts-that-narrow" title="Permanent link">&para;</a></h3>
<p>Some casts lose information. This includes the usual suspects of float to integer and wider integers to narrower ones.</p>
<pre><code class="q">q)`long$12.345
12
q)`short$123456789
32767h
</code></pre>

<p>Cast any numeric to a boolean using the C philosophy that zero is <code>0b</code> and anything else is <code>1b</code>.</p>
<pre><code class="q">q)`boolean$0
0b
q)`boolean$0.0
0b
q)`boolean$123
1b
q)`boolean$-12.345
1b
</code></pre>

<p>We can also extract constituents from complex types.</p>
<pre><code class="q">q)`date$2015.01.02D10:20:30.123456789
2015.01.02
q)`year$2015.01.02
2015i
q)`month$2015.01.02
2015.01m
q)`mm$2015.01.02
1i
q)`dd$2015.01.02
2i
q)`hh$10:20:30.123456789
10i
q)`minute$10:20:30.123456789
10:20
q)`uu$10:20:30.123456789
20i
q)`second$10:20:30.123456789
10:20:30
q)`ss$10:20:30.123456789
30i
</code></pre>

<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This is to be preferred over dot notation since the latter does not work inside functions.</p>
</div>
<h3 id="724-casting-integral-infinities">7.2.4 Casting Integral Infinities<a class="headerlink" href="index.html#724-casting-integral-infinities" title="Permanent link">&para;</a></h3>
<p>When integral infinities are cast to integers of wider type, they <strong>are</strong> their underlying bit patterns, reinterpreted. Since these bit patterns are legitimate values for the wider type, the cast results in a finite value.</p>
<pre><code class="q">q)`int$0Wh
32767i
q)`int$-0Wh
-32767i
q)`long$0Wi
2147483647
q)`long$-0Wi
-2147483647
</code></pre>

<h3 id="725-coercing-types">7.2.5 Coercing Types<a class="headerlink" href="index.html#725-coercing-types" title="Permanent link">&para;</a></h3>
<p>Casting can be used to coerce type-safe assignment. Recall that assignment into a simple list must strictly match the type.</p>
<pre><code class="q">q)L:10 20 30 40
q)L[1]:42h
'type
q)L,:43h
'type
</code></pre>

<p>This situation can arise when the list and the assignment value are created dynamically. Coerce the type by casting it to that of the target, provided of course that the cast is legitimate.</p>
<pre><code class="q">q)L[1]:(type L)$42h
q)L,:(type L)$43h
q)L
_
</code></pre>

<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The type of a simple list is positive to make this construct work.</p>
</div>
<h3 id="726-cast-is-atomic">7.2.6 Cast is Atomic<a class="headerlink" href="index.html#726-cast-is-atomic" title="Permanent link">&para;</a></h3>
<p><em>Cast</em> is atomic in the right operand.</p>
<pre><code class="q">q)&quot;i&quot;$10 20 30
10 20 30i
q)`float$(42j; 42i; 42j)
42 42 42f
</code></pre>

<p><em>Cast</em> is atomic in the left operand.</p>
<pre><code class="q">q)`short`int`long$42
42h
42i
42
q)&quot;ijf&quot;$98.6
99i
99
98.6
</code></pre>

<p><em>Cast</em> is atomic in both operands simultaneously.</p>
<pre><code class="q">q)&quot;ijf&quot;$10 20 30
10i
20
30f
</code></pre>

<h2 id="73-data-to-and-from-text">7.3 Data to and from Text<a class="headerlink" href="index.html#73-data-to-and-from-text" title="Permanent link">&para;</a></h2>
<p>Recall that a q string is a simple list of char. All grown-up programming languages have a mechanism for translating literal text into values and vice versa. It isn't strictly correct to say that converting a value to a string and parsing a string are casts since the value is only implicit in the text, but the operations are closely related and use the same operator in q.</p>
<h3 id="731-data-to-strings">7.3.1 Data to Strings<a class="headerlink" href="index.html#731-data-to-strings" title="Permanent link">&para;</a></h3>
<p>The function <code>string</code> can be applied to any q entity to produce a text representation suitable for console display or storage in a file. Here are the key features of <code>string</code>.</p>
<ul>
<li>The result is always a list of char, never a single char. Thus you will see singleton char lists from single digits.</li>
<li>The result contains no q type indicators or other decorations. In general, the result is the most compact representation of the input, which may not actually be convertible (i.e., parsed) back to the original value.</li>
<li>Applying <code>string</code> to an actual string (i.e., list of char) probably will not give you what you want.</li>
</ul>
<p>Following are some examples.</p>
<pre><code class="q">q)string 42
&quot;42&quot;
q)string 4
,&quot;4&quot;
q)string 42i
&quot;42&quot;
q)a:2.0
q)string a
,&quot;2&quot;
q)f:{x*x}
q)string f
&quot;{x*x}&quot;
</code></pre>

<p>The <code>string</code> function is clearly not atomic – for example, it takes the atom <code>42</code> to the list <code>"42"</code>. However, it is pseudo-atomic, in that it recurses into its argument and applies to the individual atoms. As such, the result conforms to the input, which explains its behavior on strings.</p>
<pre><code class="q">q)string 1 2 3
,&quot;1&quot;
,&quot;2&quot;
,&quot;3&quot;
q)string &quot;string&quot;
,&quot;s&quot;
,&quot;t&quot;
,&quot;r&quot;
,&quot;i&quot;
,&quot;n&quot;
,&quot;g&quot;
q)string (1 2 3; 10 20 30)
,&quot;1&quot; ,&quot;2&quot; ,&quot;3&quot;
&quot;10&quot; &quot;20&quot; &quot;30&quot;
</code></pre>

<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Use <code>string</code> to convert a list (or column) of symbols to strings.
<pre><code class="language-q">
q)string `Life`the`Universe`and`Everything
_
</code></pre></p>
</div>
<h3 id="732-creating-symbols-from-strings">7.3.2 Creating Symbols from Strings<a class="headerlink" href="index.html#732-creating-symbols-from-strings" title="Permanent link">&para;</a></h3>
<p>Casting from a string (i.e., a list of char) to a symbol is a foolproof way to create symbols. It is the <strong>only</strong> way to create symbols with embedded blanks or other special characters that cannot be entered into a literal symbol. To cast a char or a string to a symbol, use <code>`$</code>.</p>
<pre><code class="q">q)`$&quot;abc&quot;
`abc
q
q)`$&quot;Hello World&quot;
`_
</code></pre>

<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Do not use <code>`symbol$</code> for this as it generates an error. This is a common qbie mistake.</p>
</div>
<p>You can include any characters in a symbol this way but you may need to escape them into the string.</p>
<pre><code class="q">q)`$&quot;Zaphod \&quot;Z\&quot;&quot;
`Zaphod &quot;Z&quot;
q)`$&quot;Zaphod \n&quot;
`Zaphod
</code></pre>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The source string is left- and right-trimmed during the cast. The author knows no workaround to force leading or trailing blanks into a symbol. Why would you want them there, anyway?
<pre><code class="language-q">
q)string `$" abc "
"abc"
</code></pre></p>
</div>
<p>The monadic <code>`$</code> is atomic and will thus convert an entire list (or column) of strings to symbols.</p>
<pre><code class="q">q)`$(&quot;Life&quot;;&quot;the&quot;;&quot;Universe&quot;;&quot;and&quot;;&quot;Everything&quot;)
`Life`the`Universe`and`Everything
</code></pre>

<h3 id="733-parsing-data-from-strings">7.3.3 Parsing Data from Strings<a class="headerlink" href="index.html#733-parsing-data-from-strings" title="Permanent link">&para;</a></h3>
<p>The <code>$</code> operator is overloaded to parse strings into data of any type exactly as the q interpreter does. This overload is invoked by using an <strong>uppercase</strong> type char as the target left operand and a string in the right operand. If the specified parse cannot be performed, a null of the target type is returned – i.e., missing or bad data – instead of an exception.</p>
<pre><code class="q">q)&quot;J&quot;$&quot;42&quot;
42
q)&quot;F&quot;$&quot;42&quot;
42f
q)&quot;F&quot;$&quot;42.0&quot;
42f
q)&quot;I&quot;$&quot;42.0&quot;
0Ni
q)&quot;I&quot;$&quot; &quot;
0Ni
</code></pre>

<p>Date parsing is flexible with respect to the format of the date..</p>
<pre><code class="q">q)&quot;D&quot;$&quot;12.31.2014&quot;
2014.12.31
q)&quot;D&quot;$&quot;12-31-2014&quot;
_
q)&quot;D&quot;$&quot;12/31/2014&quot;
_
q)&quot;D&quot;$&quot;12/1/2014&quot;
_
q)&quot;D&quot;$&quot;2014/12/31&quot;
_
</code></pre>

<p>To create a function from a string, use the built-in <code>value</code>, which <strong>is</strong> the q interpreter or <code>parse</code>, which is the parse step of the interpreter.</p>
<pre><code class="q">q)value &quot;{x*x}&quot;
{x*x}
q)parse &quot;{x*x}&quot;
_
</code></pre>

<h2 id="74-creating-typed-empty-lists">7.4 Creating Typed Empty Lists<a class="headerlink" href="index.html#74-creating-typed-empty-lists" title="Permanent link">&para;</a></h2>
<p>The general empty list has type 0 since it has no items and therefore affords no canonical way to determine a type.</p>
<pre><code class="q">q)type ()
0h
</code></pre>

<p>An issue arises when appending an item in place to a general empty list, Namely, if that item is an atom, the resulting singleton list is now a simple list of the type of the atom.</p>
<pre><code class="q">q)L:()
q)type L
0h
q)L,:42
q)type L
7h
</code></pre>

<p>Should this list be a column in a table, this can be problematic. For example, suppose you intend the column to be a list of floats but the first row appended to the table happens to have a long in the field for this column. Then the errant field is accepted, the type of the column is set to long, and all subsequent appends of float raise a <code>'type</code> error.</p>
<pre><code class="q">q)c1:()
q)c1,:42
q)c1,:98.6
'type
</code></pre>

<p>To avoid this, cast the empty list using the name of the desired type, which makes it an empty simple list of that type. Now only atoms of the specified type can be appended in place.</p>
<pre><code class="q">q)c1:`float$()
q)c1,:42
'type
q)c1:98.6
q)c1
_
</code></pre>

<p>Notice that an operation that yields a simple list retains the type on an empty result.</p>
<pre><code class="q">q)0#10 20 30
_
</code></pre>

<p>This yields a succinct idiom to create typed empty lists.</p>
<pre><code class="q">q)0#0
`long$()
q)0#0.0
_
q)0#`
_
</code></pre>

<div class="admonition important">
<p class="admonition-title">Important</p>
<p>There is no way in q to type nested empty lists.</p>
</div>
<h2 id="75-enumerations">7.5 Enumerations<a class="headerlink" href="index.html#75-enumerations" title="Permanent link">&para;</a></h2>
<p>We have seen that the dyadic cast operator <code>$</code> transforms its right operand into a conforming entity of the type specified by the left operand. In the basic cast form, the left operand can be a char type abbreviation, a type short, or a symbol type name. In this section, casting is extended to user-defined target domains, providing a functional version of enumerated types.</p>
<h3 id="751-traditional-enumerations">7.5.1 Traditional Enumerations<a class="headerlink" href="index.html#751-traditional-enumerations" title="Permanent link">&para;</a></h3>
<p>To begin, recall that in traditional languages, an enumerated type is a way of associating a series of names with a corresponding set of integral values. Often the sequence of numbers is consecutive and begins with 0. The association is usually given a name and represents a new type.</p>
<p>A traditional enumerated type serves multiple purposes.</p>
<ul>
<li>It allows a descriptive name to be used instead of an arbitrary number – e.g., 'red', 'green', 'blue' instead of 0, 1 and 2.</li>
<li>It enables type checking to ensure that only permissible values are supplied – e.g., choosing a color name from a list instead of remembering its number is less prone to error.</li>
<li>It provides namespacing, meaning the same name can be reused in different domains without fear of confusion – e.g., color.blue and note.blue (the flatted fifth).</li>
</ul>
<p>There is also a subtler, more powerful use of enumerations: normalizing data.</p>
<h3 id="752-data-normalization">7.5.2 Data Normalization<a class="headerlink" href="index.html#752-data-normalization" title="Permanent link">&para;</a></h3>
<p>Broadly speaking, data normalization seeks to eliminate duplication, retaining only the minimum required data. In the archetypal example, suppose you know that you will have a list of text entries taken from a fixed and reasonably short set of values – e.g., stock exchange ticker symbols. Storing a long list of such strings verbatim presents two problems.</p>
<ul>
<li>Values of variable length complicate storage management and make retrieval inefficient.</li>
<li>There is potentially much duplication of data arising from repeated values. This is hard to keep in sync when values change.</li>
</ul>
<p>Let's see how an enumeration solves both problems. The key ingredients are a (presumably repetitive) list <code>v</code> of symbols drawn from a unique list of symbols <code>u</code>. As in the case of ticker symbols, it may be that we know the list <code>u</code> in advance.</p>
<pre><code class="q">q)u:`g`aapl`msft`ibm
q)v:1000000?u
q)v
`g`g`msft`aapl`msft`aapl`msft`ibm`msft`aapl`g`ibm`aapl`msft`msft`aapl`g..
</code></pre>

<p>Or it may be that we are given <code>v</code> and need to determine <code>u</code>.</p>
<pre><code class="q">q)v
`jha`jha`fna`fed`fna`fna`jha`jha`jgc`pkh`pkh`pkh`fna`fed`jha`cpi`pkh`pkh`igb`
q)u:distinct v
q)u
`jha`fna`fed`jgc`pkh`cpi`igb`hln`mjh`ooj
</code></pre>

<p>In any case, we have a list of symbols <code>v</code> drawn from a unique list <code>u</code>.</p>
<p>Consider a new list <code>k</code> that represents the position in <code>u</code> of each item of <code>v</code>. This can be generated by our old friend the <em>find</em> operator <code>?</code>.</p>
<pre><code class="q">q)u:`g`aapl`msft`ibm
q)v:1000000?u
q)k:u?v
q)k
2 1 1 3 3 1 0 0 0 3 0 2 2 1 2 3 1 0 1 1 2 1 2 0 2 1 1 0 1 1 3 0..
</code></pre>

<p>The key observation is that <code>u</code> and <code>k</code> together carry precisely the same information as <code>v</code>; indeed, they can be used to reconstitute it.</p>
<pre><code class="q">q)u[k]
`msft`aapl`aapl`ibm`ibm`aapl`g`g`g`ibm`g`msft`msft`aapl`msft`ibm`aapl..
q)v~u[k]
1b
</code></pre>

<p>After a bit of Zen, you will recognize that <code>u</code> and <code>k</code> exactly constitute a traditional enumeration discussed above. Indeed, <code>u</code> is the list of names, while the associated values are (implicitly) the indices of the items in <code>u</code>. Every symbol in <code>v</code> can be replaced by the corresponding index in <code>k</code> – exactly what a traditional compiler does for an enumeration.</p>
<p>Why would we want to do this trade? Easy-peasy-lemon-squeezy: speed and compactness. First, <code>v</code> is a list of variable length text, which is time-consuming to search, whereas <code>k</code> is a uniform list of integers, which is very fast to traverse. Moreover, <code>u</code> and <code>k</code> normalize the data of <code>v</code>. In general, <code>v</code> will have many repetitions of each symbol, but <code>u</code> stores each symbol once. Reading and writing the index list <code>k</code> from/to disk is a block operation that will be very fast.</p>
<div class="admonition advanced">
<p class="admonition-title">Advanced</p>
<p>Extra credit for recognizing that in terms of maps, <code>v</code> is the composite map <code>u·k</code>. For all you category theorists, we have factored the map of the non-unique list <code>v</code> through the unique list <code>u</code> via the index map <code>k</code>. Mathematically,
 <code>v = u·k</code></p>
</div>
<p>Let's examine the storage requirements for a list of symbols in more detail. Say that the count of <code>u</code> is <em>a</em> and the maximum width of the text inside the symbols in <code>u</code> is <em>b</em>. For a list <code>v</code> of variable count <em>x</em>, the amount of storage required is potentially</p>
<p><em>b</em>*<em>x</em></p>
<p>For the indexed form, the storage is known to be,</p>
<p><em>a</em>*<em>b</em>+4*<em>x</em></p>
<p>which represents the fixed amount of storage for <code>u</code> plus the variable amount of storage for the simple integer list <code>k</code>. If <em>a</em> is small and <em>b</em> is even moderately large, the factorization is significantly smaller.</p>
<p>This can be seen by comparing the sizes of <code>v</code>, <code>u</code> and <code>k</code> in a slightly modified version of our example.</p>
<pre><code class="q">v:`ccccccc`bbbbbbb`aaaaaaa`ccccccc`ccccccc`bbbbbbb
u:distinct v
u
`ccccccc`bbbbbbb`aaaaaaa
k:u?v
k
0 1 2 0 0 1
</code></pre>

<p>Now imagine <code>v</code> and <code>k</code> to be much longer.</p>
<h3 id="753-enumerating-symbols">7.5.3 Enumerating Symbols<a class="headerlink" href="index.html#753-enumerating-symbols" title="Permanent link">&para;</a></h3>
<p>The process of converting a list of symbols to the equivalent list of indices described in the previous section is called <em>enumeration</em> in q. It uses (yet another overload of) <code>$</code> with the name of the variable holding the unique symbols as the left operand and a list of symbols drawn from that domain on the right.</p>
<p>Under the covers, <code>$</code> does the indexing operation in the previous section and then replaces each symbol with its index. Fortunately, you don't have to see how the sausage is made – i.e., q hides all this from you and displays the enumerated symbols in their reconstituted form with the name of the unique domain as an annotation. Continuing the example of the previous section:</p>
<pre><code class="q">q)`u$v
`u$`msft`aapl`aapl`ibm`ibm`aapl`g`g`g`ibm`g`msft`msft`aapl`msft..
</code></pre>

<p>You can recover the underlying integer values (i.e., <code>k</code> above) by casting to an integer.</p>
<pre><code class="q">q)ev:`u$v
q)`int$ev
2 1 1 3 3 1 0 0 0 3 0 2 2 1 2 3 1 0 1 1 2 1 2 0 2 1 1 0 1 1 3 ..
</code></pre>

<p>Let's summarize. The basic form of an enumerated symbol is,</p>
<p>`u$v</p>
<p>where <code>u</code> is a simple list of unique symbols and <code>v</code> is either an atom appearing in <code>u</code> or a (possibly nested) list of such. We call <code>u</code> the <em>domain</em> of the enumeration and the projection <code>`u$</code> is <em>enumeration over <code>u</code></em>. Under the covers, applying the enumeration <code>`u$</code> to a vector <code>v</code> produces the index list <code>k</code> as above.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>For this style of enumeration, all potential values must be in the list <code>u</code>; otherwise you will get a <code>'cast</code> error when trying to enumerate.
<pre><code class="language-q">
q)u:<code>a</code>b<code>c
 q)</code>u$`d
 'cast
</code></pre></p>
</div>
<p>We shall see in <a href="index.html#757-dynamically-appending-to-an-enumeration-domain">§7.5.7</a> an alternate approach when the full extent of <code>u</code> is not known in advance.</p>
<p>When working with tables in kdb+, by convention all symbol columns in all tables are enumerated over a common domain <em>sym</em>. You will hear this referred to as the <em>sym list</em> or the <em>sym file</em>, depending on where it resides.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Although integers are 64-bit in q3+, for reasons known to the q gods, enumerations are 32-bit.</p>
</div>
<h3 id="754-using-enumerated-symbols">7.5.4 Using Enumerated Symbols<a class="headerlink" href="index.html#754-using-enumerated-symbols" title="Permanent link">&para;</a></h3>
<p>We continue with the example of the previous section, renamed to use the standard sym domain.</p>
<pre><code class="q">q)sym:`g`aapl`msft`ibm
q)v:1000000?sym
q)ev:`sym$v
</code></pre>

<p>The enumerated <code>ev</code> can be substituted for the original <code>v</code> in nearly all situations.</p>
<pre><code class="q">q)v[3]
`aapl
q)ev[3]
`u$`aapl
q)v[3]:`ibm
q)ev[3]:`ibm
q)v=`ibm
000100010010011101000010010100000000100100000001000000001100001001011..
q)ev=`ibm
q)where v=`aapl
4 5 19 20 21 31 33 34 41 42 43 49 58 59 61 74 81 83 90 94 95 98 114..
q)where ev=`aapl
4 5 19 20 21 31 33 34 41 42 43 49 58 59 61 74 81 83 90 94 95 98 114..
000100010010011101000010010100000000100100000001000000001100001001011..
q)v?`aapl
4
q)ev?`aapl
4
q)v in `ibm`aapl
000111010010011101011110010100010110100101110001010000001111011001011..
q)ev in `ibm`aapl
000111010010011101011110010100010110100101110001010000001111011001011..
</code></pre>

<p>While the enumerated version is item-wise equal to the original, the entities are not identical.</p>
<pre><code class="q">q)all v=ev
1b
q)v~ev
0b
</code></pre>

<p>This is because the types matter with <code>~</code>.</p>
<h3 id="755-type-of-enumerations">7.5.5 Type of Enumerations<a class="headerlink" href="index.html#755-type-of-enumerations" title="Permanent link">&para;</a></h3>
<p>Each enumeration is assigned a new numeric data type, beginning with <code>20h</code>. Starting with q version 3.2, the type <code>20h</code> is reserved for the conventional enumeration domain sym, whether you use it or not (you should). The types of other enumerations you create will begin with <code>21h</code> and proceed sequentially. The convention of negative type for atoms and positive type for simple lists still holds. In a fresh q session we see the following.</p>
<pre><code class="q">q)sym1:`g`aapl`msft`ibm
q)type `sym1$1000000?sym1
21h
q)sym2:`a`b`c
q)type `sym2$`c
-22h
</code></pre>

<p>In contrast, the sym domain has type <code>20h</code> even if created after another enumeration. Continuing in the previous session,</p>
<pre><code class="q">q)sym:`b`c`a
q)type `sym$100?sym
20h
</code></pre>

<p>Enumerations with different domains are distinct, even when all the constituents are the same.</p>
<pre><code class="q">q)sym1:`c`b`a
q)sym2:`c`b`a
q)ev1:`sym1$`a`b`a`c`a
q)ev2:`sym2$`a`b`a`c`a
q)ev1=ev2
11111b
q)ev1~ev2
0b
</code></pre>

<h3 id="756-updating-an-enumerated-list">7.5.6 Updating an Enumerated List<a class="headerlink" href="index.html#756-updating-an-enumerated-list" title="Permanent link">&para;</a></h3>
<p>The normalization provided by an enumeration reduces updating all occurrences of a given value to a single operation. This can have significant performance implications for large lists with many repetitions. Continuing with our example above, suppose the list <code>u</code> contains the items in a stock index and we wish to change one of the constituents. A single update to <code>u</code> suffices.</p>
<pre><code class="q">q)sym:`g`aapl`msft`ibm
q)ev:`sym$`g`g`msft`ibm`aapl`aapl`msft`ibm`msft`g`ibm`g..
q)sym[0]:`twit
q)sym
`twit`aapl`msft`ibm
q)ev
`sym$`twit`twit`msft`ibm`aapl`aapl`msft`ibm`msft`twit`ibm`twit..
</code></pre>

<p>In contrast, to make the equivalent update to <code>v</code> requires changing <strong>every</strong> occurrence.</p>
<pre><code class="q">q)v
`g`g`msft`ibm`aapl`aapl`msft`ibm`msft`g`ibm`g…
q)@[v; where v=`g; :; `twit]
_
</code></pre>

<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Be extremely cautious about modifying the sym list manually (better not to do it at all). Should you corrupt the sym list, your entire database will be scrambled! Make a persistent copy/backup before modifying the list, else update your CV after.</p>
</div>
<h3 id="757-dynamically-appending-to-an-enumeration-domain">7.5.7 Dynamically Appending to an Enumeration Domain<a class="headerlink" href="index.html#757-dynamically-appending-to-an-enumeration-domain" title="Permanent link">&para;</a></h3>
<p>One situation in which an enumeration is more complicated than working with the denormalized data is when you want to add a new value. Continuing with the example above, appending a new item to an ordinary list of symbols is a single operation. We saw in <a href="index.html#754-using-enumerated-symbols">§7.5.4</a> this is not the case when the new value is not in the enumeration domain.</p>
<pre><code class="q">q)sym:`g`aapl`msft`ibm
q)v:1000000?sym
q)ev:`sym$v
q)v,:`twtr
q)ev,:`twtr
'cast
</code></pre>

<p>The new value <strong>must</strong> first be added to the unique list.</p>
<pre><code class="q">q)sym,:`twtr
q)ev,:`twtr
</code></pre>

<p>In practice, to use <code>$</code> with dynamically generated values, you must test to see if the value you intend to append is already in the enumeration domain and, if not, append it there first. Fortunately, q has anticipated this situation.</p>
<p>If you cannot know the full extent of the enumeration domain in advance, you can use (yet another overload of) <code>?</code> to create the domain on the fly. The syntax of <code>?</code> is the same as the enumeration overload of <code>$</code> – i.e., the <strong>name</strong> of a (unique) list of symbols as left operand and a source symbol or list of symbols as right operand.</p>
<p>This application of <code>?</code> has the side effect of first checking to see if the source symbols are in the domain named by the left operand, and appends any that aren't. In any case, it returns the enumerated version of the source just like <code>$</code>.</p>
<p>You can build the enumeration domain from scratch.</p>
<pre><code class="q">q)sym:()
q)`sym$`g
'cast
q)`sym?`g
`sym$`g
q)sym
,`g
q)`sym?`ibm`aapl
`sym$`ibm`aapl
q)sym
`g`ibm`aapl
q)`sym?`g`msft
`sym$`g`msft
q)sym
`g`ibm`aapl`msft
</code></pre>

<p>Our previous example now works, with <code>?</code> in place of <code>$</code>.</p>
<pre><code class="q">q)ev,:`u?`twtr
</code></pre>

<h3 id="758-resolving-an-enumeration">7.5.8 Resolving an Enumeration<a class="headerlink" href="index.html#758-resolving-an-enumeration" title="Permanent link">&para;</a></h3>
<p>An enumerated symbol can be substituted for its equivalent symbol value in most expressions. However, there are some situations in which you need non-enumerated values. One case is converting from one enumeration domain to another, which happens when copying from one kdb+ database to another or in merging two databases.</p>
<p>Given an enumerated symbol, or a list of such, you can recover the un-enumerated value(s) by applying the built-in <code>value</code>. In our on-going example,</p>
<pre><code class="q">q)sym:`g`aapl`msft`ibm
q)v:1000000?sym
q)ev:`sym$v
q)value ev
`aapl`g`msft`msft`ibm`msft`msft`msft`msft`msft`g`ibm`ibm`ibm..
q)v~value ev
1b
</code></pre>

<p>This is another overload of <code>value</code>, the function that is essentially the q interpreter.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../6_Functions.1" title="6. Functions" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                6. Functions
              </span>
            </div>
          </a>
        
        
          <a href="../8_Tables.1" title="8. Tables" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                8. Tables
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            ©2015 Jeffry A. Borror / q4m LLC. Kx® and kdb+ are registered trademarks of Kx Systems, Inc., a subsidiary of First Derivatives plc.
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.b438e6c5.js"></script>
      
      <script>app.initialize({version:"0.17.3",url:{base:".."}})</script>
      
        <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
      
        <script src="https://tracker.mrpfd.com/tracker.js"></script>
      
        <script src="http://code.kx.com/scripts/googleanalytics.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
        <script src="https://use.fontawesome.com/3dbf29ed12.js"></script>
      
        <script src="http://code.kx.com/scripts/prism.js"></script>
      
    
    
      
    
  </body>
</html>